<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta charset="utf-8" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <link rel="stylesheet" type="text/css" href="main.css" />
    <title>freeCodeCamp.org Code Radio</title>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-55446531-21"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "UA-55446531-21");
    </script>
  </head>

  <body>
    <nav class="site-nav nav-padding" id="site-nav">
      <div class="site-nav-left"></div>
      <div class="site-nav-middle">
        <a class="site-nav-logo" href="https://coderadio.freecodecamp.org/"
          ><img
            src="https://cdn-media-1.freecodecamp.org/code-radio/FCC-logo.png"
            alt="Code Radio"
        /></a>
      </div>
      <div class="site-nav-right main-nav">
        <div class="main-nav-group">
          <ul class="nav" role="menu" id="nav">
            <li class="nav-learn" role="menuitem">
              <a href="https://learn.freecodecamp.org/">Learn</a>
            </li>
            <li class="nav-forum" role="menuitem">
              <a href="https://www.freecodecamp.org/forum/">Forum</a>
            </li>
            <li class="nav-news nav-current" role="menuitem">
              <a href="https://www.freecodecamp.org/news/">News</a>
            </li>
          </ul>
        </div>
      </div>
      <button class="site-nav-right toggle-button-nav" id="toggle-button-nav">
        Menu
      </button>
    </nav>
    <div class="under-header-content jumbotron">
      <h1 class="site-title">Welcome to Code Radio.</h1>
      <h2 class="site-description">
        24/7 music designed for coding.
      </h2>
    </div>
    <div class="container">
      <div class="middle">
        <iframe
          src="https://coderadio-admin.freecodecamp.org/public/coderadio/embed"
          frameborder="0"
          allowtransparency="true"
          style="width: 100%; height: 106px; border: 0;"
        ></iframe>
        <hr />
        <p id="listeners-num"></p>
      </div>
    </div>
  </body>
</html>

<script type="text/javascript">
  function showMenu() {
    toggleClass("toggle-button-nav", "reverse-toggle-color");
    toggleClass("nav", "show-main-nav-items");
    toggleClass("site-nav", "expand-nav");
  }

  function toggleClass(id, className) {
    var d = document.getElementById(id);
    d.classList.toggle(className);
  }

  if (window && window.addEventListener) {
    window.addEventListener("load", function() {
      document.getElementById("toggle-button-nav").onclick = showMenu;
    });
  }

  //making the call to azuracast api for listeners nums
  var xhr = new XMLHttpRequest();

  function reqListener() {
    var listenerNum = JSON.parse(this.response)[0].listeners.total;
    listenerMounter(listenerNum);
    setTimeout(callMaker, 20000);
  }

  function listenerMounter(number) {
    var d = document.getElementById("listeners-num");
    d.textContent = number + " coders listening right now";
  }

  function callMaker() {
    xhr.addEventListener("load", reqListener);
    xhr.open("GET", "https://coderadio-admin.freecodecamp.org/api/nowplaying");
    xhr.send();
  }

  callMaker();
</script>
